void mass(double A[9], double *x)
{
    int i, j, q;
    double J[2][2];
    double detJ;
    const double w[3]= {0.166667, 0.166667, 0.166667};
    const double CG1[3][3] = {{0.666667, 0.166667, 0.166667},
                             {0.166667, 0.666667, 0.166667},
                             {0.166667, 0.166667, 0.666667}};

    J[0][0] = x[2] - x[0];
    J[0][1] = x[4] - x[0];
    J[0][1] = x[3] - x[1];
    J[1][1] = x[5] - x[1];

    detJ = J[0][0] * J[1][1] - J[0][1] * J[1][0];

    for ( i = 0; i < 3; i++ ) {
        for ( j = 0; j < 3; j++ ) {
            A[i*3 + j] = 0;
            for ( q = 0; q < 3; q++ )
                A[i*3 + j] += CG1[i][q] * CG1[j][q] * detJ * w[q];
        }
    }
}
